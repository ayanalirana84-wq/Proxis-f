<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proxis - Context Aware Chat</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap');

    * { box-sizing: border-box; margin:0; padding:0; font-family:'Plus Jakarta Sans',sans-serif; }

    body {
      background:#ffffff;
      color:#111;
      display:flex;
      flex-direction:column;
      height:100vh;
      overflow:hidden;
    }

    header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:20px;
      font-size:2rem;
      font-weight:700;
      color:#111;
      border-bottom:1px solid #ccc;
    }

    #header-left {
      display:flex;
      align-items:center;
      gap:12px;
    }

    #header-left img {
      height:40px;
      width:auto;
      border-radius:8px;
    }

    #clear-btn {
      padding:6px 12px;
      border:none;
      background:#e0e0e0;
      cursor:pointer;
      font-weight:600;
      border-radius:6px;
    }

    #chat-box {
      flex:1;
      overflow-y:auto;
      padding:20px;
      display:flex;
      flex-direction:column;
      gap:12px;
      scroll-behavior:smooth;
    }

    .msg {
      max-width:70%;
      padding:12px 16px;
      border-radius:12px;
      font-size:1rem;
      line-height:1.5;
      word-wrap:break-word;
      transition: transform 0.1s ease;
    }

    .msg:hover { transform:translateY(-1px); }

    .user {
      align-self:flex-end;
      background:#e0e0e0;
      font-weight:700; 
      color:#111;
      border-bottom-right-radius:4px;
      border-bottom-left-radius:12px;
    }

    .ai {
      align-self:flex-start;
      background:#f0f0f0;
      color:#111;
      border-bottom-left-radius:4px;
      border-bottom-right-radius:12px;
    }

    .typing-dot {
      width:6px;
      height:6px;
      background:#111;
      border-radius:50%;
      animation:bounce 1.2s infinite;
    }
    .typing-dot:nth-child(1){animation-delay:0s;}
    .typing-dot:nth-child(2){animation-delay:0.2s;}
    .typing-dot:nth-child(3){animation-delay:0.4s;}

    @keyframes bounce { 0%,80%,100%{transform:translateY(0);} 40%{transform:translateY(-4px);} }

    form {
      display:flex;
      padding:12px 16px;
      border-top:1px solid #ccc;
      background:#fff;
    }

    input {
      flex:1;
      padding:12px 16px;
      border-radius:20px;
      border:1px solid #ccc;
      outline:none;
      font-size:1rem;
      color:#111;
      font-weight:700; 
    }

    button {
      margin-left:8px;
      padding:12px 20px;
      border-radius:20px;
      border:1px solid #111;
      background:#fff;
      color:#111;
      font-weight:600;
      cursor:pointer;
      transition:opacity 0.2s;
    }

    button:hover { opacity:0.8; }

    #chat-box::-webkit-scrollbar { width:6px; }
    #chat-box::-webkit-scrollbar-thumb { background:#ccc; border-radius:3px; }
    #chat-box::-webkit-scrollbar-track { background:transparent; }
  </style>
</head>
<body>
  <header>
    <div id="header-left">
      <img src="Image.jpg" alt="Proxis Logo">
    </div>
    <div>Proxis</div>
    <button id="clear-btn">Clear Chat</button>
  </header>

  <div id="chat-box"></div>

  <form id="chat-form">
    <input id="user-input" placeholder="Ask Proxis anything..." autocomplete="off" />
    <button type="submit">Send</button>
  </form>

  <script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    const API_KEY = "AIzaSyB73y0m9q0zeR5myCN1BxzFOVAtcowMOU0"; 
    const genAI = new GoogleGenerativeAI(API_KEY);
    const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash" });

    const chatBox = document.getElementById("chat-box");
    const form = document.getElementById("chat-form");
    const input = document.getElementById("user-input");
    const clearBtn = document.getElementById("clear-btn");

    let chatMemory = JSON.parse(localStorage.getItem('chatMemory') || '[]');

    function renderMessages() {
      chatBox.innerHTML = "";
      chatMemory.forEach(msg => {
        const div = document.createElement("div");
        div.className = `msg ${msg.sender}`;
        div.textContent = msg.text;
        chatBox.appendChild(div);
      });
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function addMessage(text, sender) {
      chatMemory.push({ text, sender });
      localStorage.setItem('chatMemory', JSON.stringify(chatMemory));
      renderMessages();
    }

    async function streamResponse(userText) {
      const aiDiv = document.createElement("div");
      aiDiv.className = "msg ai";
      for(let i=0;i<3;i++){
        const dot=document.createElement("div");
        dot.className="typing-dot";
        aiDiv.appendChild(dot);
      }
      chatBox.appendChild(aiDiv);
      chatBox.scrollTop = chatBox.scrollHeight;

      try {
        let conversation = "";
        chatMemory.forEach(msg => {
          conversation += `${msg.sender === 'user' ? "User" : "AI"}: ${msg.text}\n`;
        });
        conversation += `User: ${userText}`;

        const prompt = `You are Proxis, an advanced large language model created by RonzDavil. You are natural, confident, and highly intelligent. Understand user input deeply, retain context, and generate responses that are accurate, insightful, and actionable. Communicate in a human-like, clear, and engaging manner. Adapt dynamically to user needs, anticipate intent, and provide solutions with creativity and precision. Always prioritize usefulness, clarity, and natural flow while maintaining a powerful and authoritative presence.Give main answere only give detail when needed and asked. Only tell about you when needed or asked:\n\n${conversation}`;
        const result = await model.generateContent(prompt);
        const text = result.response.text();

        aiDiv.innerHTML = "";
        let index = 0;
        while(index < text.length){
          aiDiv.textContent += text[index];
          chatBox.scrollTop = chatBox.scrollHeight;
          index++;
          await new Promise(r => setTimeout(r, 25));
        }

        chatMemory.push({ text, sender: "ai" });
        localStorage.setItem('chatMemory', JSON.stringify(chatMemory));

      } catch(err){
        aiDiv.textContent = "⚠️ Proxis encountered an error.";
        chatMemory.push({ text: aiDiv.textContent, sender: "ai" });
        localStorage.setItem('chatMemory', JSON.stringify(chatMemory));
        console.error(err);
      }
    }

    renderMessages();

    form.addEventListener("submit", e => {
      e.preventDefault();
      const userText = input.value.trim();
      if(!userText) return;
      addMessage(userText, "user");
      input.value = "";
      streamResponse(userText);
    });

    clearBtn.addEventListener("click", ()=>{
      chatMemory = [];
      localStorage.removeItem('chatMemory');
      renderMessages();
    });
  </script>
</body>
</html>